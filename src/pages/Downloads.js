import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useEffect, useState } from 'react';
import { publicApi } from '../lib/api';
import Card from '../components/Card';
import Badge from '../components/Badge';
import { DocumentTextIcon, PlayCircleIcon, ArrowDownTrayIcon, FilmIcon } from '@heroicons/react/24/outline';
const Downloads = () => {
    const [resources, setResources] = useState([]);
    const [loading, setLoading] = useState(true);
    useEffect(() => {
        publicApi.getDownloads()
            .then(setResources)
            .catch(console.error)
            .finally(() => setLoading(false));
    }, []);
    const documents = resources.filter(r => ['doc', 'docx', 'pdf', 'ppt', 'pptx', 'xls', 'xlsx', 'txt'].includes(r.type) || r.type === 'pdf');
    const videos = resources.filter(r => ['video', 'mp4', 'mkv', 'avi', 'mov', 'link'].includes(r.type) || r.type === 'video');
    if (loading)
        return _jsx("div", { className: "p-20 text-center text-slate-500", children: "Loading resources..." });
    const baseUrl = (import.meta.env.VITE_API_URL || 'http://localhost:4000/api').replace('/api', '');
    return (_jsxs("div", { className: "mx-auto max-w-6xl px-4 py-16 md:px-6 lg:px-8", children: [_jsxs("div", { className: "mb-10 text-center", children: [_jsx(Badge, { children: "Resources" }), _jsx("h1", { className: "mt-3 text-3xl font-bold text-slate-900", children: "Downloads & Materials" }), _jsx("p", { className: "mt-2 text-slate-600", children: "Access study documents and watch educational videos." })] }), _jsxs("div", { className: "space-y-12", children: [_jsxs("div", { className: "space-y-6", children: [_jsxs("div", { className: "flex items-center gap-3 border-b border-slate-200 pb-4", children: [_jsx("div", { className: "bg-blue-100 p-2 rounded-lg text-blue-600", children: _jsx(DocumentTextIcon, { className: "h-6 w-6" }) }), _jsx("h2", { className: "text-2xl font-bold text-slate-900", children: "Documents" })] }), documents.length === 0 ? (_jsx("div", { className: "text-center text-slate-500 py-10 bg-slate-50 rounded-xl border border-dashed border-slate-200", children: "No documents available." })) : (_jsx("div", { className: "grid gap-6 md:grid-cols-2 lg:grid-cols-3", children: documents.map(doc => (_jsxs(Card, { className: "flex flex-col justify-between h-full hover:shadow-lg transition-shadow", children: [_jsxs("div", { className: "flex items-start gap-4", children: [_jsx("div", { className: "bg-blue-50 p-3 rounded-lg text-blue-600", children: _jsx(DocumentTextIcon, { className: "h-6 w-6" }) }), _jsxs("div", { children: [_jsx("h3", { className: "font-semibold text-slate-900 line-clamp-2", children: doc.title }), _jsxs("p", { className: "text-xs text-slate-500 mt-1 uppercase font-medium", children: [doc.type, " \u2022 ", new Date(doc.createdAt).toLocaleDateString()] })] })] }), _jsx("div", { className: "mt-4 pt-4 border-t border-slate-100", children: _jsxs("a", { href: doc.url.startsWith('http') ? doc.url : `${baseUrl}${doc.url}`, download: !doc.url.startsWith('http'), target: "_blank", rel: "noopener noreferrer", className: "flex items-center justify-center gap-2 w-full rounded-lg bg-slate-100 py-2.5 text-sm font-medium text-slate-700 hover:bg-slate-200 transition-colors", children: [_jsx(ArrowDownTrayIcon, { className: "h-4 w-4" }), "Download"] }) })] }, doc._id))) }))] }), _jsxs("div", { className: "space-y-6", children: [_jsxs("div", { className: "flex items-center gap-3 border-b border-slate-200 pb-4", children: [_jsx("div", { className: "bg-red-100 p-2 rounded-lg text-red-600", children: _jsx(FilmIcon, { className: "h-6 w-6" }) }), _jsx("h2", { className: "text-2xl font-bold text-slate-900", children: "Video Resources" })] }), videos.length === 0 ? (_jsx("div", { className: "text-center text-slate-500 py-10 bg-slate-50 rounded-xl border border-dashed border-slate-200", children: "No videos available." })) : (_jsx("div", { className: "grid gap-6 md:grid-cols-2 lg:grid-cols-3", children: videos.map(video => (_jsxs(Card, { className: "flex flex-col justify-between h-full hover:shadow-lg transition-shadow", children: [_jsxs("div", { className: "flex items-start gap-4", children: [_jsx("div", { className: "bg-red-50 p-3 rounded-lg text-red-600", children: _jsx(PlayCircleIcon, { className: "h-6 w-6" }) }), _jsxs("div", { children: [_jsx("h3", { className: "font-semibold text-slate-900 line-clamp-2", children: video.title }), _jsxs("p", { className: "text-xs text-slate-500 mt-1 uppercase font-medium", children: [video.type, " \u2022 ", new Date(video.createdAt).toLocaleDateString()] })] })] }), _jsx("div", { className: "mt-4 pt-4 border-t border-slate-100", children: _jsxs("a", { href: video.url.startsWith('http') ? video.url : `${baseUrl}${video.url}`, target: "_blank", rel: "noopener noreferrer", className: "flex items-center justify-center gap-2 w-full rounded-lg bg-brand-50 py-2.5 text-sm font-medium text-brand-700 hover:bg-brand-100 transition-colors", children: [_jsx(PlayCircleIcon, { className: "h-4 w-4" }), video.type === 'link' ? 'Watch Now' : 'Download Video'] }) })] }, video._id))) }))] })] })] }));
};
export default Downloads;
